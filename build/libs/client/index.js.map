{"version":3,"sources":["../../../src/libs/client/index.js"],"names":["micro","clientOptions","errors","host","includes","push","some","property","error","TypeError","code","details","options","die"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA;kBACe,UAACA,KAAD,EAAQC,aAAR,EAA0B;AACvC,MAAI,sBAASA,aAAT,CAAJ,EAA6B;AAC3B,WAAO,4BAAaD,KAAb,EAAoBC,aAApB,CAAP;AACD;;AAED,MAAMC,SAAS,CAAE,MAAF,EAAU,MAAV,EAAkB,MAAlB,CAAf;AALuC,MAMjCC,IANiC,GAMxBF,aANwB,CAMjCE,IANiC;;;AAQvC,MAAIA,SAAS,SAAb,EAAwB;AACtBA,WAAO,WAAP;AACD;;AAED,MAAI,CAAE,WAAF,EAAe,WAAf,EAA6BC,QAA7B,CAAsCD,IAAtC,CAAJ,EAAiD;AAC/CD,WAAOG,IAAP,CAAY,MAAZ;AACD;;AAEDH,SAAOI,IAAP,CAAY,oBAAY;AACtB,QAAI,CAACL,cAAeM,QAAf,CAAL,EAAgC;AAC9B,UAAMC,QAAQ,IAAIC,SAAJ,mLAAmDF,QAAnD,0EAAd;AACAC,YAAME,IAAN,8BAAuCH,QAAvC;AACAC,YAAMG,OAAN,GAAgB,EAAEC,SAASX,aAAX,EAAhB;AACAD,YAAMa,GAAN,CAAUL,KAAV;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAP;AACD,GAVD;;AAYA,SAAO,4BAAaR,KAAb,EAAoBC,aAApB,CAAP;AACD,C","file":"index.js","sourcesContent":["import isString from 'lodash.isstring';\nimport clientGetter from './client-getter';\nimport clientSetter from './client-setter';\n\n// Регистрирует клиента\nexport default (micro, clientOptions) => {\n  if (isString(clientOptions)) {\n    return clientGetter(micro, clientOptions);\n  }\n  \n  const errors = [ 'name', 'type', 'host' ];\n  let { host } = clientOptions;\n  \n  if (host === '0.0.0.0') {\n    host = '127.0.0.1';\n  }\n  \n  if ([ '127.0.0.1', 'localhost' ].includes(host)) {\n    errors.push('port');\n  }\n  \n  errors.some(property => {\n    if (!clientOptions[ property ]) {\n      const error = new TypeError(`При добавлении клиента свойство \"${ property }\" обязательно`);\n      error.code = `error.client.property.${ property }.is.required`;\n      error.details = { options: clientOptions };\n      micro.die(error);\n      return true;\n    }\n    \n    return false;\n  });\n  \n  return clientSetter(micro, clientOptions);\n};"]}