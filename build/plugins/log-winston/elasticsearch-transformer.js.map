{"version":3,"sources":["../../../src/plugins/log-winston/elasticsearch-transformer.js"],"names":["transformer","timestamp","Date","toISOString","message","severity","level","meta","pin","action","plugin","app","request","other","fields","add","undefined","id","duration","module","exports","name","value","JSON","stringify"],"mappings":";;;;;;AAAA,MAAMA,cAAc,SAASA,WAAT,OAKjB;AAAA,4BAJDC,SAIC;AAAA,MAJDA,SAIC,kCAJW,IAAIC,IAAJ,GAAWC,WAAX,EAIX;AAAA,MAHDC,OAGC,QAHDA,OAGC;AAAA,MAFKC,QAEL,QAFDC,KAEC;AAAA,uBADDC,IACC;AAAA,MADDA,IACC,6BADM,EACN;;AAAA,QACOC,GADP,GACuDD,IADvD,CACOC,GADP;AAAA,QACYC,MADZ,GACuDF,IADvD,CACYE,MADZ;AAAA,QACoBC,MADpB,GACuDH,IADvD,CACoBG,MADpB;AAAA,QAC4BC,GAD5B,GACuDJ,IADvD,CAC4BI,GAD5B;AAAA,QACiCC,OADjC,GACuDL,IADvD,CACiCK,OADjC;AAAA,QAC6CC,KAD7C,4BACuDN,IADvD;;AAED,QAAMO,sBACDD,KADC,CAAN;;AAIAE,MAAID,MAAJ,EAAY,KAAZ,EAAmBN,GAAnB;AACAO,MAAID,MAAJ,EAAY,QAAZ,EAAsBJ,MAAtB;AACAK,MAAID,MAAJ,EAAY,QAAZ,EAAsBL,MAAtB;;AAEA,SAAO;AACLL,WADK;AAELC,YAFK;AAGLM,OAHK;AAILG,UAJK;AAKL,kBAAcb,SALT;AAMLW,aAAc,CAACA,OAAD,GAAWI,SAAX,GAAuB;AACnCC,UAAUL,QAAQK,EADiB;AAEnCC,gBAAUN,QAAQM,QAAR;AAFyB;AANhC,GAAP;AAWD,CA1BD;;AA4BAC,OAAOC,OAAP,GAAiBpB,WAAjB;;AAEA,SAASe,GAAT,CAAaD,MAAb,EAAqBO,IAArB,EAA2BC,KAA3B,EAAkC;AAChC,MAAIA,KAAJ,EAAW;AACTR,WAAQO,IAAR,IAAiBE,KAAKC,SAAL,CAAeF,KAAf,CAAjB;AACD;AACF","file":"elasticsearch-transformer.js","sourcesContent":["const transformer = function transformer({\n  timestamp = new Date().toISOString(),\n  message,\n  level:severity,\n  meta = {}\n}) {\n  const { pin, action, plugin, app, request, ...other } = meta;\n  const fields = {\n    ...other\n  };\n  \n  add(fields, 'pin', pin);\n  add(fields, 'plugin', plugin);\n  add(fields, 'action', action);\n  \n  return {\n    message,\n    severity,\n    app,\n    fields,\n    '@timestamp': timestamp,\n    request     : !request ? undefined : {\n      id      : request.id,\n      duration: request.duration()\n    }\n  };\n};\n\nmodule.exports = transformer;\n\nfunction add(fields, name, value) {\n  if (value) {\n    fields[ name ] = JSON.stringify(value);\n  }\n}\n"]}