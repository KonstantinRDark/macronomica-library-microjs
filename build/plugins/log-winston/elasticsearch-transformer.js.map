{"version":3,"sources":["../../../src/plugins/log-winston/elasticsearch-transformer.js"],"names":["transformer","timestamp","Date","toISOString","message","severity","level","meta","pin","action","plugin","other","fields","add","module","exports","name","value","JSON","stringify"],"mappings":";;;;AAAA;;;;AACA;;;;;;;;AAEA,MAAMA,cAAc,SAASA,WAAT,OAKjB;AAAA,4BAJDC,SAIC;AAAA,MAJDA,SAIC,kCAJW,IAAIC,IAAJ,GAAWC,WAAX,EAIX;AAAA,MAHDC,OAGC,QAHDA,OAGC;AAAA,MAFKC,QAEL,QAFDC,KAEC;AAAA,uBADDC,IACC;AAAA,MADDA,IACC,6BADM,EACN;;AAAA,QACOC,GADP,GACyCD,IADzC,CACOC,GADP;AAAA,QACYC,MADZ,GACyCF,IADzC,CACYE,MADZ;AAAA,QACoBC,MADpB,GACyCH,IADzC,CACoBG,MADpB;AAAA,QAC+BC,KAD/B,4BACyCJ,IADzC;;AAED,QAAMK,sBACDD,KADC,CAAN;;AAIAE,MAAID,MAAJ,EAAY,KAAZ,EAAmBJ,GAAnB;AACAK,MAAID,MAAJ,EAAY,QAAZ,EAAsBF,MAAtB;AACAG,MAAID,MAAJ,EAAY,QAAZ,EAAsBH,MAAtB;;AAEA,SAAO;AACL,kBAAcR,SADT;AAELG,WAFK;AAGLC,YAHK;AAILO;AAJK,GAAP;AAMD,CArBD;;AAuBAE,OAAOC,OAAP,GAAiBf,WAAjB;;AAEA,SAASa,GAAT,CAAaD,MAAb,EAAqBI,IAArB,EAA2BC,KAA3B,EAAkC;AAChC,MAAIA,KAAJ,EAAW;AACTL,WAAQI,IAAR,IAAiBE,KAAKC,SAAL,CAAeF,KAAf,CAAjB;AACD;AACF","file":"elasticsearch-transformer.js","sourcesContent":["import isPlainObject from 'lodash.isplainobject';\nimport jsonic from 'jsonic';\n\nconst transformer = function transformer({\n  timestamp = new Date().toISOString(),\n  message,\n  level:severity,\n  meta = {}\n}) {\n  const { pin, action, plugin, ...other } = meta;\n  const fields = {\n    ...other\n  };\n  \n  add(fields, 'pin', pin);\n  add(fields, 'plugin', plugin);\n  add(fields, 'action', action);\n  \n  return {\n    '@timestamp': timestamp,\n    message,\n    severity,\n    fields\n  };\n};\n\nmodule.exports = transformer;\n\nfunction add(fields, name, value) {\n  if (value) {\n    fields[ name ] = JSON.stringify(value);\n  }\n}\n"]}