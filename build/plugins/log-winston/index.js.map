{"version":3,"sources":["../../../src/plugins/log-winston/index.js"],"names":["settings","microjs","onClose","plugin","id","logPin","logger","Logger","level","log","levels","LEVELS","add","transports","Console","cmd","message","payload","del"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;;;kBAEe,YAA0B;AAAA,iFAAP,EAAO;AAAA,MAApBA,QAAoB;;AACvC,SAAO,UAACC,OAAD,SAA0B;AAAA,QAAdC,OAAc,SAAdA,OAAc;;AAC/B,QAAMC,SAAS,EAAEC,IAAI,sBAAN,EAAf;AACA,QAAMC,SAAS,qBAAf;AACA,QAAIC,SAAS,IAAK,kBAAQC,MAAb,CAAqB;AAChCC,aAAQP,QAAQQ,GAAR,CAAYD,KADY;AAEhCE,cAAQT,QAAQQ,GAAR,CAAYE;AAFY,KAArB,CAAb;;AAKAL,WAAOM,GAAP,CAAW,kBAAQC,UAAR,CAAmBC,OAA9B;;AAGAb,YAAQW,GAAR,CAAYP,MAAZ,EAAoB;AAAA,UAAGU,GAAH,SAAGA,GAAH;AAAA,UAAQP,KAAR,SAAQA,KAAR;AAAA,UAAeQ,OAAf,SAAeA,OAAf;AAAA,UAAwBC,OAAxB,SAAwBA,OAAxB;AAAA,aAAsCX,OAAQE,KAAR,EAAgBQ,OAAhB,EAAyBC,OAAzB,CAAtC;AAAA,KAApB;;AAEAf,YAAQ,YAAM;AACZI,eAAS,IAAT;AACAL,cAAQiB,GAAR,CAAYb,MAAZ;AACD,KAHD;;AAKA,WAAOF,MAAP;AACD,GAnBD;AAoBD,C","file":"index.js","sourcesContent":["import winston from 'winston';\nimport genid from './../../utils/genid';\n\nexport default ({ ...settings } = {}) => {\n  return (microjs, { onClose }) => {\n    const plugin = { id: genid() };\n    const logPin = 'cmd:logger, level:*';\n    let logger = new (winston.Logger)({\n      level : microjs.log.level,\n      levels: microjs.log.LEVELS\n    });\n\n    logger.add(winston.transports.Console);\n\n\n    microjs.add(logPin, ({ cmd, level, message, payload }) => logger[ level ](message, payload));\n\n    onClose(() => {\n      logger = null;\n      microjs.del(logPin);\n    });\n\n    return plugin;\n  }\n};"]}