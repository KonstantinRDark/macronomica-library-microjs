{"version":3,"sources":["../../../src/plugins/log-winston/index.js"],"names":["settings","micro","onClose","plugin","id","logger","Logger","level","log","levels","LEVELS","add","transports","Console","label","emit","on","message","payload"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;kBAEe,YAA0B;AAAA,iFAAP,EAAO;;AAAA,MAApBA,QAAoB;;AACvC,SAAO,CAACC,KAAD,YAAwB;AAAA,QAAdC,OAAc,SAAdA,OAAc;;AAC7B,UAAMC,SAAS,EAAEC,IAAI,sBAAN,EAAf;;AAEA,QAAIC,SAAS,IAAK,kBAAQC,MAAb;AACXC,aAAQN,MAAMO,GAAN,CAAUD,KADP;AAEXE,cAAQR,MAAMO,GAAN,CAAUE;AAFP,OAGRV,QAHQ,EAAb;;AAMAK,WAAOM,GAAP,CAAW,kBAAQC,UAAR,CAAmBC,OAA9B,EAAwC;AACtCC,aAAOb,MAAMG;AADyB,KAAxC;;AAIAH,UAAMc,IAAN,CAAW,mBAAX;AACAd,UAAMe,EAAN,CAAS,KAAT,EAAgB;AAAA,UAAGT,KAAH,SAAGA,KAAH;AAAA,UAAUU,OAAV,SAAUA,OAAV;AAAA,UAAmBC,OAAnB,SAAmBA,OAAnB;AAAA,aAAiCb,OAAQE,KAAR,EAAgBU,OAAhB,EAAyBC,OAAzB,CAAjC;AAAA,KAAhB;;AAEAhB,YAAQ,MAAM;AACZD,YAAMc,IAAN,CAAW,qBAAX;AACAV,eAAS,IAAT;AACD,KAHD;;AAKA,WAAOF,MAAP;AACD,GAtBD;AAuBD,C","file":"index.js","sourcesContent":["import winston from 'winston';\nimport genid from './../../utils/genid';\n\nexport default ({ ...settings } = {}) => {\n  return (micro, { onClose }) => {\n    const plugin = { id: genid() };\n\n    let logger = new (winston.Logger)({\n      level : micro.log.level,\n      levels: micro.log.LEVELS,\n      ...settings\n    });\n\n    logger.add(winston.transports.Console, ({\n      label: micro.id\n    }));\n\n    micro.emit('plugin.logger.use');\n    micro.on('log', ({ level, message, payload }) => logger[ level ](message, payload));\n\n    onClose(() => {\n      micro.emit('plugin.logger.unuse');\n      logger = null;\n    });\n\n    return plugin;\n  }\n};"]}